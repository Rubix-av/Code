<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <h1>Countries Data</h1>
  <button id="loadBtn" style="cursor: pointer; background: greenyellow; border: none; padding: 5px; border-radius: 5px">Load Data</button>

  <div id="country-data" style="display: none; margin-top: 30px"></div>

  <script>
    load_btn = document.getElementById("loadBtn")
    load_btn.addEventListener("click", async () => {
      load_btn.style.background = "yellow"
      document.getElementById("country-data").style.display = "none"
      try {
        const response = await fetch("http://127.0.0.1:8000/get_countries");
        const data = await response.json()

        const container = document.getElementById("country-data")
        container.innerHTML = ""
        data.forEach(country => {
          const div = document.createElement("div");
          div.style.marginBottom = "20px";
          div.innerHTML = `
            <strong>${country.name}</strong><br>
            Capital : ${country.capital}<br>
            Population : ${country.population}<br>
            Area : ${country.area}
          `;
          container.appendChild(div)
        })
        
      }
      catch {
        const container = document.getElementById("country-data")
        container.innerHTML = ""

        const span = document.createElement("span")
        span.style.color = "red"
        span.innerHTML = "Failed to fetch results!"
        container.appendChild(span)
        console.error("Some error occured")
      }
      finally {
        load_btn.style.background = "greenyellow"
        document.getElementById("country-data").style.display = "block"
      }
    })
  </script>

</body>
</html>